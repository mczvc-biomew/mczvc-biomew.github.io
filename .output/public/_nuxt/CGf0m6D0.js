import{_ as b}from"./D9FqfwK5.js";import{d as A,f as F,a as s,r as d,m as p,l as V,n as w,D as P,o as L,c as M,y as T,e as q,q as N,z as j,A as G,t as H,T as U,C as r,p as i,ak as B,E as $}from"./CGTIcIDm.js";import{u as J}from"./_f6tJiM_.js";const K=["src","data-author","data-title","type"],O=A({__name:"Music",props:{musicFile:String,musicAuthor:String,musicTitle:String,musicType:{default:"audio/mp3",type:String}},setup(x){F(e=>({"572635c4":s(f)})),J({script:[{src:"/vendor/js/visualizer.js"}]});const c=x,n=d(),u=d(),l=p("musicSingleton",()=>!1),v=d(),t=d("not-started"),z=e=>{e.preventDefault(),s(t)==="playing"?(r("#canvas","bounce"),i("#canvas","active")):s(t)==="paused"&&(setTimeout(()=>{i("#canvas","bounce")},500),r("#canvas","active")),i("#canvas","always-show")},m=(e=!0)=>{r(".pause-icon",["paused","closed"]),r("#canvas","paused");try{s(n).loaded||n.value.loadSound(),e&&s(l)&&n.value.playSound(),t.value="playing"}catch(a){console.error(a),console.warn("Error playing sound"),t.value="disposed"}},D=e=>{if(e.preventDefault(),!s(n)){l.value=!1,g()&&(n.value.loadSound(),r(".pause-icon",["closed","paused"]));return}if(s(t)==="playing"){if(!n.value.loaded||!n.value.isPlaying)return;n.value.pauseSound(),t.value="paused";const a=document.getElementById("hero");if(a){const o=["hover","foreground"];(!B(a,"foreground")||!B(a,"hover"))&&i(a,o)}i(".pause-icon","paused"),i("#canvas","paused")}else s(t)==="paused"?(n.value.dispose(),t.value="disposed",i(".pause-icon","closed"),n.value=null,v.value=null):s(t)},I=e=>{if(t.value=e==="running"?"playing":e==="suspended"?"paused":e==="closed"?"disposed":"not-started",s(t)!=="playing")if(s(t)==="paused"){const a=document.getElementById("hero");a&&r(a,["foreground"]),m()}else s(t)==="not-started"&&(n.value.loadSound(),m())},f=d("49");p("music-top",()=>f.value);const _=()=>{setTimeout(()=>{f.value=p("music-top").value+"px"},300)},g=()=>"__lazyMusicLoader"in window&&c.musicFile.length>0&&!s(l)?(window.__lazyMusicLoader.then(e=>{if(v.value=e(),v.value){if(n.value=v.value(I),!s(n))return!1;m(!1)}else return!1}),l.value=!0,!!s(n)):(l.value=!1,!1),E=e=>{_(),s(l)||g(),i(s(u),"activated")},S=e=>{if(e.target===u.value){e.stopPropagation();const a=document.getElementById("hero");a&&i(a,["hover"])}},C=e=>{if(e.target===u.value){e.stopPropagation();const a=document.getElementById("hero");a&&r(a,["hover"])}},h=()=>{_()};return V(()=>{var e,a,o;w(()=>c.musicFile,y=>{var k;(k=n.value)==null||k.dispose(),l.value=!1,g(),t.value="playing"}),(e=document.querySelector(".app"))==null||e.addEventListener("onDockingStationAvailable",h),w(p("music-top"),()=>{h()},{immediate:!0}),document.documentElement.addEventListener("click",E),(a=u.value)==null||a.addEventListener("mouseenter",S),(o=u.value)==null||o.addEventListener("mouseleave",C)}),P(()=>{var e,a,o,y;(e=document.querySelector(".app"))==null||e.removeEventListener("onDockingStationAvailable",h),(a=n.value)==null||a.dispose(),l.value=!1,document.documentElement.removeEventListener("click",E),(o=u.value)==null||o.removeEventListener("mouseenter",S),(y=u.value)==null||y.removeEventListener("mouseleave",C)}),(e,a)=>{const o=b;return L(),M("div",{class:"music",onClick:z},[T(o,{icon:"pause-icon",onClick:D}),c.musicFile.length>0?(L(),M("audio",{key:0,id:"audio",src:c.musicFile,"data-author":c.musicAuthor,"data-title":c.musicTitle,type:c.musicType},null,8,K)):q("",!0),T(U,{name:"bounce"},{default:N(()=>[j(H("canvas",{id:"canvas",width:"340",height:"400",ref_key:"canvas",ref:u},null,512),[[G,s(t)==="playing"||s(t)==="disposed"]])]),_:1})])}}}),X=$(O,[["__scopeId","data-v-29ed7966"]]);export{X as default};
