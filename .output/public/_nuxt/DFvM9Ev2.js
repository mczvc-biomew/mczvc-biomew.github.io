import{_ as A}from"./Bz_UBu0U.js";import{d as F,ao as H,f as P,a as s,r as d,m as p,l as q,n as b,H as N,o as I,c as T,y as x,e as j,q as G,z as J,A as U,t as W,T as $,E as r,p as i,V as K,ap as B,I as O}from"./C2cKJNh5.js";import{u as Q}from"./DosWHU0D.js";const R=["src","data-author","data-title","type"],X=F({__name:"Music",props:{musicFile:String,musicAuthor:String,musicTitle:String,musicType:{default:"audio/mp3",type:String},fgColor:{default:"",type:String},rewindIcon:{default:"url("+H("/assets/img/icons/rock.svg")+")",type:String}},setup(M){P(e=>({f19fd46c:s(z),"3a1f4bfc":s(m)})),Q({script:[{src:"/vendor/js/visualizer.js"}]});const t=M,n=d(),l=d(),c=p("musicSingleton",()=>!1),v=d(),z=d(t.rewindIcon),o=d("not-started"),D=e=>{e.preventDefault(),s(o)==="playing"?(r("#canvas","bounce"),i("#canvas","active")):s(o)==="paused"&&(setTimeout(()=>{i("#canvas","bounce")},500),r("#canvas","active"),o.value="not-started",K(()=>o.value="paused")),i("#canvas","always-show")},f=(e=!0)=>{r(".pause-icon",["paused","closed"]),r("#canvas","paused");try{s(n).loaded||n.value.loadSound(),e&&s(c)&&n.value.playSound(),o.value="playing"}catch(a){console.error(a),console.warn("Error playing sound"),o.value="disposed"}},V=e=>{if(e.preventDefault(),!s(n)){c.value=!1,g()&&(n.value.loadSound(),r(".pause-icon",["closed","paused"]));return}if(s(o)==="playing"){if(!n.value.loaded||!n.value.isPlaying)return;n.value.pauseSound(),o.value="paused";const a=document.getElementById("hero");if(a){const u=["hover","foreground"];(!B(a,"foreground")||!B(a,"hover"))&&i(a,u)}i(".pause-icon","paused"),i("#canvas","paused")}else s(o)==="paused"?(n.value.dispose(),o.value="disposed",i(".pause-icon","closed"),n.value=null,v.value=null):s(o)},_=e=>{if(o.value=e==="running"?"playing":e==="suspended"?"paused":e==="closed"?"disposed":"not-started",s(o)!=="playing")if(s(o)==="paused"){const a=document.getElementById("hero");a&&r(a,["foreground"]),f()}else s(o)==="not-started"&&(n.value.loadSound(),f())},m=d("49");p("music-top",()=>m.value);const S=()=>{setTimeout(()=>{m.value=p("music-top").value+"px"},300)},g=()=>"__lazyMusicLoader"in window&&t.musicFile.length>0&&!s(c)?(window.__lazyMusicLoader.then(e=>{if(v.value=e(),s(v)){const a={autoplay:!0,loop:!0,audio:"audio",canvas:"canvas",style:"lounge",barWidth:2,barHeight:2,barSpacing:7,barColor:t.fgColor,shadowBlur:5,shadowColor:"#ffffff0a",font:["32px","Jelly Sugar"],clickHandler:_};if(n.value=v.value(_,t.fgColor?a:void 0),!s(n))return!1;f(!1)}else return!1}),c.value=!0,!!s(n)):(c.value=!1,!1),E=e=>{S(),s(c)||g(),i(s(l),"activated")},C=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&i(a,["hover"])}},w=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&r(a,["hover"])}},h=()=>{S()};return q(()=>{var e,a,u;b(()=>t.musicFile,y=>{var k,L;(k=n.value)==null||k.pauseSound(),(L=n.value)==null||L.dispose(),c.value=!1,g(),o.value="playing"}),(e=document.querySelector(".app"))==null||e.addEventListener("onDockingStationAvailable",h),b(p("music-top"),()=>{h()},{immediate:!0}),document.documentElement.addEventListener("click",E),(a=l.value)==null||a.addEventListener("mouseenter",C),(u=l.value)==null||u.addEventListener("mouseleave",w)}),N(()=>{var e,a,u,y;(e=document.querySelector(".app"))==null||e.removeEventListener("onDockingStationAvailable",h),(a=n.value)==null||a.dispose(),c.value=!1,document.documentElement.removeEventListener("click",E),(u=l.value)==null||u.removeEventListener("mouseenter",C),(y=l.value)==null||y.removeEventListener("mouseleave",w)}),(e,a)=>{const u=A;return I(),T("div",{class:"music",onClick:D},[x(u,{icon:"pause-icon",onClick:V}),t.musicFile.length>0?(I(),T("audio",{key:0,id:"audio",src:t.musicFile,"data-author":t.musicAuthor,"data-title":t.musicTitle,type:t.musicType},null,8,R)):j("",!0),x($,{name:"bounce"},{default:G(()=>[J(W("canvas",{id:"canvas",width:"340",height:"400",ref_key:"canvas",ref:l},null,512),[[U,s(o)==="playing"||s(o)==="paused"]])]),_:1})])}}}),ae=O(X,[["__scopeId","data-v-58ada825"]]);export{ae as default};
