import{u as E}from"./FcGSMqk-.js";import{u as C}from"./DuoAXaPS.js";import{o as k,s as m,a,n as _}from"./D_P_Mt2j.js";import{d as h,r as w,l as R,n as S,ah as P,j as O,o as D,c as $,G as u,a as t,e as b,ai as x}from"./CNjcTgzP.js";k({id:m(),runtimeConfig:a(k({locale:a(m())})),tokenId:a(m()),cookieDomain:a(m()),cookieExpiry:a(_())});function A(f){let d=Promise.resolve();return C("crisp",o=>({scriptInput:{src:"https://client.crisp.chat/l.js"},schema:void 0,scriptOptions:{use(){const e=r=>{var s;return((s=window.$crisp)==null?void 0:s[r])||((...c)=>{d.then(()=>window.$crisp[r](...c))})};return{push:window.$crisp.push,do:e("do"),set:e("set"),get:e("get"),on:e("on"),off:e("off"),config:e("config"),help:e("help")}}},clientInit:()=>{var e;window.$crisp=[],window.CRISP_WEBSITE_ID=o.id,(e=o.runtimeConfig)!=null&&e.locale&&(window.CRISP_RUNTIME_CONFIG={locale:o.runtimeConfig.locale}),o.cookieDomain&&(window.CRISP_COOKIE_DOMAIN=o.cookieDomain),o.cookieExpiry&&(window.CRISP_COOKIE_EXPIRATION=o.cookieExpiry),o.tokenId&&(window.CRISP_TOKEN_ID=o.tokenId),d=new Promise(r=>{window.CRISP_READY_TRIGGER=r})}}),f)}const L=h({__name:"ScriptCrisp",props:{trigger:{type:[String,Array,Boolean],default:"click"},id:{},runtimeConfig:{},tokenId:{},cookieDomain:{},cookieExpiry:{}},emits:["ready","error"],setup(f,{expose:d,emit:o}){const e=f,r=o,s=w(null),c=E({trigger:e.trigger,el:s}),l=w(!1),g=A({id:e.id,runtimeConfig:e.runtimeConfig,tokenId:e.tokenId,cookieDomain:e.cookieDomain,cookieExpiry:e.cookieExpiry,scriptOptions:{trigger:c}}),{onLoaded:I,status:p}=g;e.trigger==="click"&&I(i=>{i.do("chat:open")}),d({crisp:g});let n;R(()=>{S(p,i=>{i==="loaded"?(n=new MutationObserver(()=>{document.getElementById("crisp-chatbox")&&(l.value=!0,r("ready",g),n.disconnect())}),n.observe(document.body,{childList:!0,subtree:!0})):i==="error"&&r("error")})}),P(()=>{n==null||n.disconnect()});const y=O(()=>({...c instanceof Promise?c.ssrAttrs||{}:{}}));return(i,B)=>(D(),$("div",x({ref_key:"rootEl",ref:s,style:{display:t(l)?"none":"block"}},t(y)),[u(i.$slots,"default",{ready:t(l)}),t(p)==="awaitingLoad"?u(i.$slots,"awaitingLoad",{key:0}):t(p)==="loading"||!t(l)?u(i.$slots,"loading",{key:1}):t(p)==="error"?u(i.$slots,"error",{key:2}):b("",!0)],16))}});export{L as default};
