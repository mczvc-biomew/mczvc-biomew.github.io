import{_ as F}from"./DxFwjn25.js";import{d as V,f as q,a as s,r as d,m as p,O as H,l as P,n as L,H as N,o as b,c as B,A as T,e as j,q as G,B as J,C as O,t as U,T as W,E as r,p as u,X,aq as x,I as $}from"./CpvMD2BZ.js";import{u as K}from"./ECLeJkIC.js";const Q=["src","data-author","data-title","type"],R=V({__name:"Music",props:{musicFile:String,musicAuthor:String,musicTitle:String,musicType:{default:"audio/mp3",type:String},fgColor:{default:"",type:String},rewindIcon:{default:"",type:String}},setup(M){q(e=>({"62dfd6dc":s(z),"15cf0d0e":s(f)})),K({script:[{src:"/vendor/js/visualizer.js"}]});const t=M,n=d(),l=d(),c=p("musicSingleton",()=>!1),v=d(),z=d(t.rewindIcon.length>0?t.rewindIcon:'url("'+H("/assets/img/icons/rock.svg")+'")'),o=d("not-started"),D=e=>{e.preventDefault(),s(o)==="playing"?(r("#canvas","bounce"),u("#canvas","active")):s(o)==="paused"&&(setTimeout(()=>{u("#canvas","bounce")},500),r("#canvas","active"),o.value="not-started",X(()=>o.value="paused")),u("#canvas","always-show")},m=(e=!0)=>{r(".pause-icon",["paused","closed"]),r("#canvas","paused");try{s(n).loaded||n.value.loadSound(),e&&s(c)&&n.value.playSound(),o.value="playing"}catch(a){console.error(a),console.warn("Error playing sound"),o.value="disposed"}},A=e=>{if(e.preventDefault(),!s(n)){c.value=!1,g()&&(n.value.loadSound(),r(".pause-icon",["closed","paused"]));return}if(s(o)==="playing"){if(!n.value.loaded||!n.value.isPlaying)return;n.value.pauseSound(),o.value="paused";const a=document.getElementById("hero");if(a){const i=["hover","foreground"];(!x(a,"foreground")||!x(a,"hover"))&&u(a,i)}u(".pause-icon","paused"),u("#canvas","paused")}else s(o)==="paused"?(n.value.dispose(),o.value="disposed",u(".pause-icon","closed"),n.value=null,v.value=null):s(o)},_=e=>{if(o.value=e==="running"?"playing":e==="suspended"?"paused":e==="closed"?"disposed":"not-started",s(o)!=="playing")if(s(o)==="paused"){const a=document.getElementById("hero");a&&r(a,["foreground"]),m()}else s(o)==="not-started"&&(n.value.loadSound(),m())},f=d("49");p("music-top",()=>f.value);const S=()=>{setTimeout(()=>{f.value=p("music-top").value+"px"},300)},g=()=>"__lazyMusicLoader"in window&&t.musicFile.length>0&&!s(c)?(window.__lazyMusicLoader.then(e=>{if(v.value=e(),s(v)){const a={autoplay:!0,loop:!0,audio:"audio",canvas:"canvas",style:"lounge",barWidth:2,barHeight:2,barSpacing:7,barColor:t.fgColor,shadowBlur:5,shadowColor:"#ffffff0a",font:["32px","Jelly Sugar"],clickHandler:_};if(n.value=v.value(_,t.fgColor?a:void 0),!s(n))return!1;m(!1)}else return!1}),c.value=!0,!!s(n)):(c.value=!1,!1),C=e=>{S(),s(c)||g(),u(s(l),"activated")},E=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&u(a,["hover"])}},w=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&r(a,["hover"])}},h=()=>{S()};return P(()=>{var e,a,i;L(()=>t.musicFile,y=>{var k,I;(k=n.value)==null||k.pauseSound(),(I=n.value)==null||I.dispose(),c.value=!1,g(),o.value="playing"}),(e=document.querySelector(".app"))==null||e.addEventListener("onDockingStationAvailable",h),L(p("music-top"),()=>{h()},{immediate:!0}),document.documentElement.addEventListener("click",C),(a=l.value)==null||a.addEventListener("mouseenter",E),(i=l.value)==null||i.addEventListener("mouseleave",w)}),N(()=>{var e,a,i,y;(e=document.querySelector(".app"))==null||e.removeEventListener("onDockingStationAvailable",h),(a=n.value)==null||a.dispose(),c.value=!1,document.documentElement.removeEventListener("click",C),(i=l.value)==null||i.removeEventListener("mouseenter",E),(y=l.value)==null||y.removeEventListener("mouseleave",w)}),(e,a)=>{const i=F;return b(),B("div",{class:"music",onClick:D},[T(i,{icon:"pause-icon",onClick:A}),t.musicFile.length>0?(b(),B("audio",{key:0,id:"audio",src:t.musicFile,"data-author":t.musicAuthor,"data-title":t.musicTitle,type:t.musicType},null,8,Q)):j("",!0),T(W,{name:"bounce"},{default:G(()=>[J(U("canvas",{id:"canvas",width:"340",height:"400",ref_key:"canvas",ref:l},null,512),[[O,s(o)==="playing"||s(o)==="paused"]])]),_:1})])}}}),ae=$(R,[["__scopeId","data-v-21a58e0b"]]);export{ae as default};
