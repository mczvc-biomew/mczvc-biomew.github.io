import{_ as H}from"./DEDcgmwc.js";import{d as N,m as P,a as o,i as r,x as v,Y as b,j,y as L,k as q,o as B,c as M,H as x,e as G,A as R,I as $,J,B as U,T as W,L as d,z as u,R as Y,aB as z,ah as K,_ as O}from"./-wh18xAP.js";import{u as Q}from"./I3g5k0r6.js";const X=["src","data-author","data-title","type"],Z=N({__name:"Music",props:{musicFile:String,musicAuthor:String,musicTitle:String,musicType:{default:"audio/mp3",type:String},fgColor:{default:"#0eaedf9e",type:String},shadowColor:{default:"#06272f",type:String},stopIcon:{default:"",type:String},rewindIcon:{default:"",type:String},font:{default:"Gotham Condensed Black",type:String},fontSize:{default:48,type:Number},musicLoop:{default:!0,type:Boolean},onMusicEnded:{default:()=>{},type:Function}},setup(T){P(e=>({"7219e38c":o(D),"8a7de8f6":o(F),"6db041b7":o(f)})),Q({script:[{src:"/vendor/js/visualizer.js"}]});const t=T,n=r(),l=r(),c=v("musicSingleton",()=>!1),p=r(),D=r(t.stopIcon.length>0?t.stopIcon:`url("${b("/assets/img/icons/stop.svg")}")`),F=r(t.rewindIcon.length>0?t.rewindIcon:'url("'+b("/assets/img/icons/rock.svg")+'")'),s=r("not-started"),A=e=>{e.preventDefault(),o(s)==="playing"?(d("#canvas","bounce"),u("#canvas","active")):o(s)==="paused"&&(setTimeout(()=>{u("#canvas","bounce")},500),d("#canvas","active"),s.value="not-started",Y(()=>s.value="paused")),u("#canvas","always-show")},m=(e=!0)=>{d(".pause-icon",["paused","closed"]),d("#canvas","paused");try{o(n).loaded||n.value.loadSound(),e&&o(c)&&n.value.playSound(),s.value="playing"}catch(a){console.error(a),console.warn("Error playing sound"),s.value="disposed"}},V=e=>{e.preventDefault();const a=document.getElementById("hero");if(!o(n)){c.value=!1,g()&&(n.value.loadSound(),d(".pause-icon",["closed","paused"]));return}if(o(s)==="playing"){if(!n.value.loaded||!n.value.isPlaying)return;if(n.value.pauseSound(),s.value="paused",a){const i=["hover","foreground"];(!z(a,"foreground")||!z(a,"hover"))&&u(a,i)}u(".pause-icon","paused"),u("#canvas","paused")}else o(s)==="paused"?(n.value.dispose(),s.value="disposed",u(".pause-icon","closed"),n.value=null,p.value=null):o(s)},S=e=>{if(s.value=e==="running"?"playing":e==="suspended"?"paused":e==="closed"?"disposed":"not-started",o(s)!=="playing")if(o(s)==="paused"){const a=document.getElementById("hero");a&&d(a,["foreground"]),m()}else o(s)==="not-started"&&(n.value.loadSound(),m())},f=r("49");v("music-top",()=>f.value);const _=()=>{setTimeout(()=>{f.value=v("music-top").value+"px"},300)},g=()=>"__lazyMusicLoader"in window&&t.musicFile.length>0&&!o(c)?(window.__lazyMusicLoader.then(e=>{if(p.value=e(),o(p)){const a={autoplay:!0,loop:K(t.musicLoop),audio:"audio",canvas:"canvas",style:"lounge",barWidth:2,barHeight:2,barSpacing:7,barColor:t.fgColor,shadowBlur:5,shadowColor:t.shadowColor,font:["32px",t.font,""],fontSize:t.fontSize,clickHandler:S,onMusicEnded:t.onMusicEnded};if(n.value=p.value(S,a),!o(n))return!1;m(!1)}else return!1}),c.value=!0,!!o(n)):(c.value=!1,!1),E=e=>{_(),o(c)||g(),u(o(l),"activated")},C=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&u(a,["hover"])}},w=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&d(a,["hover"])}},h=()=>{_()};return j(()=>{var e,a,i;L(()=>t.musicFile,y=>{var k,I;(k=n.value)==null||k.pauseSound(),(I=n.value)==null||I.dispose(),c.value=!1,g(),s.value="playing"}),(e=document.querySelector(".app"))==null||e.addEventListener("onDockingStationAvailable",h),L(v("music-top"),()=>{h()},{immediate:!0}),document.documentElement.addEventListener("click",E),(a=l.value)==null||a.addEventListener("mouseenter",C),(i=l.value)==null||i.addEventListener("mouseleave",w)}),q(()=>{var e,a,i,y;(e=document.querySelector(".app"))==null||e.removeEventListener("onDockingStationAvailable",h),(a=n.value)==null||a.dispose(),c.value=!1,document.documentElement.removeEventListener("click",E),(i=l.value)==null||i.removeEventListener("mouseenter",C),(y=l.value)==null||y.removeEventListener("mouseleave",w)}),(e,a)=>{const i=H;return B(),M("div",{class:"music",onClick:A},[x(i,{icon:"pause-icon",onClick:V}),t.musicFile.length>0?(B(),M("audio",{key:0,id:"audio",src:t.musicFile,"data-author":t.musicAuthor,"data-title":t.musicTitle,type:t.musicType},null,8,X)):G("",!0),x(W,{name:"bounce"},{default:R(()=>[$(U("canvas",{id:"canvas",width:"340",height:"400",ref_key:"canvas",ref:l},null,512),[[J,o(s)==="playing"||o(s)==="paused"]])]),_:1})])}}}),se=O(Z,[["__scopeId","data-v-ba84cbcd"]]);export{se as default};
