import{_ as V}from"./Dj_V_iLb.js";import{d as A,ao as F,f as H,a as s,r as d,m as p,l as P,n as b,H as q,o as L,c as I,y as T,e as N,q as j,z as G,A as J,t as U,T as W,E as r,p as u,V as $,ap as x,I as K}from"./weV2c1rj.js";import{u as O}from"./CPjVciia.js";const Q=["src","data-author","data-title","type"],R=A({__name:"Music",props:{musicFile:String,musicAuthor:String,musicTitle:String,musicType:{default:"audio/mp3",type:String},fgColor:{default:"",type:String},rewindIcon:{default:"url("+F("/assets/img/icons/rock.svg")+")",type:String}},setup(B){H(e=>({"809bb91a":s(M),"72a159a5":s(f)})),O({script:[{src:"/vendor/js/visualizer.js"}]});const t=B,n=d(),l=d(),c=p("musicSingleton",()=>!1),v=d(),M=d(t.rewindIcon),o=d("not-started"),z=e=>{e.preventDefault(),s(o)==="playing"?(r("#canvas","bounce"),u("#canvas","active")):s(o)==="paused"&&(setTimeout(()=>{u("#canvas","bounce")},500),r("#canvas","active"),o.value="not-started",$(()=>o.value="paused")),u("#canvas","always-show")},m=(e=!0)=>{r(".pause-icon",["paused","closed"]),r("#canvas","paused");try{s(n).loaded||n.value.loadSound(),e&&s(c)&&n.value.playSound(),o.value="playing"}catch(a){console.error(a),console.warn("Error playing sound"),o.value="disposed"}},D=e=>{if(e.preventDefault(),!s(n)){c.value=!1,g()&&(n.value.loadSound(),r(".pause-icon",["closed","paused"]));return}if(s(o)==="playing"){if(!n.value.loaded||!n.value.isPlaying)return;n.value.pauseSound(),o.value="paused";const a=document.getElementById("hero");if(a){const i=["hover","foreground"];(!x(a,"foreground")||!x(a,"hover"))&&u(a,i)}u(".pause-icon","paused"),u("#canvas","paused")}else s(o)==="paused"?(n.value.dispose(),o.value="disposed",u(".pause-icon","closed"),n.value=null,v.value=null):s(o)},_=e=>{if(o.value=e==="running"?"playing":e==="suspended"?"paused":e==="closed"?"disposed":"not-started",s(o)!=="playing")if(s(o)==="paused"){const a=document.getElementById("hero");a&&r(a,["foreground"]),m()}else s(o)==="not-started"&&(n.value.loadSound(),m())},f=d("49");p("music-top",()=>f.value);const S=()=>{setTimeout(()=>{f.value=p("music-top").value+"px"},300)},g=()=>"__lazyMusicLoader"in window&&t.musicFile.length>0&&!s(c)?(window.__lazyMusicLoader.then(e=>{if(v.value=e(),s(v)){const a={autoplay:!0,loop:!0,audio:"audio",canvas:"canvas",style:"lounge",barWidth:2,barHeight:2,barSpacing:7,barColor:t.fgColor,shadowBlur:5,shadowColor:"#ffffff0a",font:["32px","Jelly Sugar"],clickHandler:_};if(n.value=v.value(_,t.fgColor?a:void 0),!s(n))return!1;m(!1)}else return!1}),c.value=!0,!!s(n)):(c.value=!1,!1),E=e=>{S(),s(c)||g(),u(s(l),"activated")},C=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&u(a,["hover"])}},w=e=>{if(e.target===l.value){e.stopPropagation();const a=document.getElementById("hero");a&&r(a,["hover"])}},h=()=>{S()};return P(()=>{var e,a,i;b(()=>t.musicFile,y=>{var k;(k=n.value)==null||k.dispose(),c.value=!1,g(),o.value="playing"}),(e=document.querySelector(".app"))==null||e.addEventListener("onDockingStationAvailable",h),b(p("music-top"),()=>{h()},{immediate:!0}),document.documentElement.addEventListener("click",E),(a=l.value)==null||a.addEventListener("mouseenter",C),(i=l.value)==null||i.addEventListener("mouseleave",w)}),q(()=>{var e,a,i,y;(e=document.querySelector(".app"))==null||e.removeEventListener("onDockingStationAvailable",h),(a=n.value)==null||a.dispose(),c.value=!1,document.documentElement.removeEventListener("click",E),(i=l.value)==null||i.removeEventListener("mouseenter",C),(y=l.value)==null||y.removeEventListener("mouseleave",w)}),(e,a)=>{const i=V;return L(),I("div",{class:"music",onClick:z},[T(i,{icon:"pause-icon",onClick:D}),t.musicFile.length>0?(L(),I("audio",{key:0,id:"audio",src:t.musicFile,"data-author":t.musicAuthor,"data-title":t.musicTitle,type:t.musicType},null,8,Q)):N("",!0),T(W,{name:"bounce"},{default:j(()=>[G(U("canvas",{id:"canvas",width:"340",height:"400",ref_key:"canvas",ref:l},null,512),[[J,s(o)==="playing"||s(o)==="paused"]])]),_:1})])}}}),ee=K(R,[["__scopeId","data-v-a6c3a1b6"]]);export{ee as default};
