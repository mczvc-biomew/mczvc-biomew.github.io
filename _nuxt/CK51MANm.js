import R from"./CWKkcMEd.js";import{H as P,d as z,r as b,h as n,f as D,aC as F,c as A,K as j,a3 as c,b as d,M as x,n as H,aO as w,e as m,o as O,aS as I,m as q,aI as S}from"./7VwHqc1T.js";import{u as M}from"./CvF53tB7.js";import{u as W,a as K}from"./BUVEqv7m.js";import{u as U}from"./FeTMOz9B.js";function G(g){const u=W("vimeoPlayer",()=>({scriptInput:{src:"https://player.vimeo.com/api/player.js"},scriptOptions:{use(){return{Vimeo:window.Vimeo}}}}),g);{const p=P(u.status,o=>{o==="loading"&&(K({link:[{rel:"preconnect",href:"https://i.vimeocdn.com"},{rel:"preconnect",href:"https://f.vimeocdn.com"},{rel:"preconnect",href:"https://fresnel.vimeocdn.com"}]}),p())})}return u}const ee=z({__name:"ScriptVimeoPlayer",props:{trigger:{type:[String,Array,Boolean],default:"mousedown"},placeholderAttrs:{},rootAttrs:{},aboveTheFold:{type:Boolean},vimeoOptions:{},id:{},url:{}},emits:["play","playing","pause","ended","timeupdate","progress","seeking","seeked","texttrackchange","chapterchange","cuechange","cuepoint","volumechange","playbackratechange","bufferstart","bufferend","error","loaded","durationchange","fullscreenchange","qualitychange","camerachange","resize","enterpictureinpicture","leavepictureinpicture"],setup(g,{expose:u,emit:p}){const o=g,V=p,T=["play","playing","pause","ended","timeupdate","progress","seeking","seeked","texttrackchange","chapterchange","cuechange","cuepoint","volumechange","playbackratechange","bufferstart","bufferend","error","loaded","durationchange","fullscreenchange","qualitychange","camerachange","resize","enterpictureinpicture","leavepictureinpicture"],l=b(),y=b(),s=M({trigger:o.trigger,el:y});let h=!1;o.trigger==="mousedown"&&s instanceof Promise&&s.then(t=>{t&&(h=!0)});const f=b(!1),{onLoaded:$,status:i}=G({scriptOptions:{trigger:s}}),v=n(()=>{var t;return((t=o.vimeoOptions)==null?void 0:t.id)||o.id}),{data:L}=U(`vimeo-embed:${v.value}`,()=>$fetch(`https://vimeo.com/api/v2/video/${v.value}.json`).then(t=>t[0]),{watch:[v]}),k=n(()=>{var t;return(t=L.value)==null?void 0:t.thumbnail_large});let e;u({play:()=>e==null?void 0:e.play(),pause:()=>e==null?void 0:e.pause(),getDuration:()=>e==null?void 0:e.getDuration(),getCurrentTime:()=>e==null?void 0:e.getCurrentTime(),setCurrentTime:t=>e==null?void 0:e.setCurrentTime(t),getVolume:()=>e==null?void 0:e.getVolume(),setVolume:t=>e==null?void 0:e.setVolume(t),getPaused:()=>e==null?void 0:e.getPaused(),getEnded:()=>e==null?void 0:e.getEnded(),getLoop:()=>e==null?void 0:e.getLoop(),setLoop:t=>e==null?void 0:e.setLoop(t),getPlaybackRate:()=>e==null?void 0:e.getPlaybackRate(),setPlaybackRate:t=>e==null?void 0:e.setPlaybackRate(t)});const _=n(()=>{var t,a,r;return((t=o.vimeoOptions)==null?void 0:t.width)||((r=(a=l.value)==null?void 0:a.parentNode)==null?void 0:r.offsetWidth)||640}),C=n(()=>{var t,a,r;return((t=o.vimeoOptions)==null?void 0:t.height)||((r=(a=l.value)==null?void 0:a.parentNode)==null?void 0:r.offsetHeight)||480});D(()=>{$(async({Vimeo:t})=>{const a=o.vimeoOptions||{};!a.id&&o.id&&(a.id=o.id),!a.url&&o.url&&(a.url=o.url),a.width=_.value,a.height=C.value,e=new t.Player(l.value,a),h&&(e.play(),h=!1);for(const r of T)e.on(r,N=>{V(r,N,e),r==="loaded"&&(f.value=!0)})})}),P(()=>o.id,t=>{t&&(e==null||e.loadVideo(Number(t)))}),P(i,t=>{t==="error"&&V("error")});const B=n(()=>S(o.rootAttrs,{"aria-busy":i.value==="loading","aria-label":i.value==="awaitingLoad"?"Vimeo Player - Placeholder":i.value==="loading"?"Vimeo Player - Loading":"Vimeo Player - Loaded","aria-live":"polite",role:"application",style:{maxWidth:"100%",width:`${_.value}px`,height:"auto",aspectRatio:"16/9",position:"relative",backgroundColor:"black"},...s instanceof Promise?s.ssrAttrs||{}:{}})),E=n(()=>S(o.placeholderAttrs,{src:k.value,alt:"",loading:o.aboveTheFold?"eager":"lazy",fetchpriority:o.aboveTheFold?"high":void 0,style:{cursor:"pointer",width:"100%",objectFit:"contain",height:"100%"}}));return F(()=>e==null?void 0:e.unload()),(t,a)=>{const r=R;return O(),A("div",w({ref_key:"rootEl",ref:y},B.value),[j(H("div",{ref_key:"elVimeo",ref:l,class:"vimeo-player"},null,512),[[x,f.value]]),f.value?d("",!0):c(t.$slots,"placeholder",w({key:0},m(L),{placeholder:k.value}),()=>[k.value?(O(),A("img",I(w({key:0},E.value)),null,16)):d("",!0)]),m(i)==="loading"?c(t.$slots,"loading",{key:1},()=>[q(r,{color:"white"})]):d("",!0),m(i)==="awaitingLoad"?c(t.$slots,"awaitingLoad",{key:2}):m(i)==="error"?c(t.$slots,"error",{key:3}):d("",!0),c(t.$slots,"default")],16)}}});export{ee as default};
