import{_ as I}from"./8gc3G6G6.js";import{d as A,f as F,a as t,r as d,m as p,l as V,n as w,D as q,o as L,c as b,y as M,e as N,q as P,z as j,A as G,t as H,T as U,C as l,p as o,ak as T,E as $}from"./B36AOwRh.js";import{u as J}from"./kr80fRxR.js";const K=["src","data-author","data-title","type"],O=A({__name:"Music",props:{musicFile:String,musicAuthor:String,musicTitle:String,musicType:{default:"audio/mp3",type:String}},setup(x){F(e=>({"2bbaf79b":t(m)})),J({script:[{src:"/vendor/js/visualizer.js"}]});const c=x,u=d(),i=d(),r=p("musicSingleton",()=>!1),v=d(),a=d("not-started"),z=e=>{e.preventDefault(),t(a)==="playing"?(l("#canvas","bounce"),o("#canvas","active")):t(a)==="paused"&&(setTimeout(()=>{o("#canvas","bounce")},500),l("#canvas","active")),o("#canvas","always-show")},_=()=>{l(".pause-icon",["paused","closed"]),l("#canvas","paused"),u.value.playSound(),a.value="playing"},B=e=>{if(e.preventDefault(),t(a)==="playing"){u.value.pauseSound();const s=document.getElementById("hero");if(s){const n=["hover","foreground"];(!T(s,"foreground")||!T(s,"hover"))&&o(s,n)}o(".pause-icon","paused"),o("#canvas","paused"),a.value="paused"}else t(a)==="paused"?(u.value.dispose(),a.value="disposed",o(".pause-icon","closed"),u.value=null,v.value=null):t(a)==="disposed"&&(r.value=!1,f(),l(".pause-icon",["closed","paused"]))},D=e=>{if(a.value=e==="running"?"playing":e==="suspended"?"paused":e==="closed"?"disposed":"not-started",t(a)!=="playing"){if(t(a)==="paused"){const s=document.getElementById("hero");s&&l(s,["foreground"]),_()}}},m=d("49");p("music-top",()=>m.value);const y=()=>{setTimeout(()=>{m.value=p("music-top").value+"px"},300)},f=()=>{"__lazyMusicLoader"in window&&c.musicFile.length>0&&(window.__lazyMusicLoader.then(e=>{v.value=e(),v.value&&(u.value=v.value(D),_())}),r.value=!0)},E=e=>{y(),t(r)||f(),o(t(i),"activated")},S=e=>{if(e.target===i.value){e.stopPropagation();const s=document.getElementById("hero");s&&o(s,["hover"])}},C=e=>{if(e.target===i.value){e.stopPropagation();const s=document.getElementById("hero");s&&l(s,["hover"])}},g=()=>{y()};return V(()=>{var e,s,n;w(()=>c.musicFile,h=>{var k;(k=u.value)==null||k.dispose(),r.value=!1,f(),a.value="playing"}),(e=document.querySelector(".app"))==null||e.addEventListener("onDockingStationAvailable",g),w(p("music-top"),()=>{g()},{immediate:!0}),document.documentElement.addEventListener("click",E),(s=i.value)==null||s.addEventListener("mouseenter",S),(n=i.value)==null||n.addEventListener("mouseleave",C)}),q(()=>{var e,s,n,h;(e=document.querySelector(".app"))==null||e.removeEventListener("onDockingStationAvailable",g),(s=u.value)==null||s.dispose(),r.value=!1,document.documentElement.removeEventListener("click",E),(n=i.value)==null||n.removeEventListener("mouseenter",S),(h=i.value)==null||h.removeEventListener("mouseleave",C)}),(e,s)=>{const n=I;return L(),b("div",{class:"music",onClick:z},[M(n,{icon:"pause-icon",onClick:B}),c.musicFile.length>0?(L(),b("audio",{key:0,id:"audio",src:c.musicFile,"data-author":c.musicAuthor,"data-title":c.musicTitle,type:c.musicType},null,8,K)):N("",!0),M(U,{name:"bounce"},{default:P(()=>[j(H("canvas",{id:"canvas",width:"340",height:"400",ref_key:"canvas",ref:i},null,512),[[G,t(a)==="playing"||t(a)==="disposed"]])]),_:1})])}}}),X=$(O,[["__scopeId","data-v-84cc2863"]]);export{X as default};
