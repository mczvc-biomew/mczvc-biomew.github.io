import{_ as I}from"./guWGhkX7.js";import{d as A,f as F,a as s,r as d,m as p,l as P,n as w,D as V,o as L,c as T,y as M,e as q,q as N,z as j,A as G,t as H,T as U,C as r,p as u,P as $,ak as x,E as J}from"./DXBtOycP.js";import{u as K}from"./CRvofjOM.js";const O=["src","data-author","data-title","type"],Q=A({__name:"Music",props:{musicFile:String,musicAuthor:String,musicTitle:String,musicType:{default:"audio/mp3",type:String}},setup(B){F(e=>({b18cdacc:s(f)})),K({script:[{src:"/vendor/js/visualizer.js"}]});const c=B,t=d(),i=d(),l=p("musicSingleton",()=>!1),v=d(),n=d("not-started"),b=e=>{e.preventDefault(),s(n)==="playing"?(r("#canvas","bounce"),u("#canvas","active")):s(n)==="paused"&&(setTimeout(()=>{u("#canvas","bounce")},500),r("#canvas","active"),n.value="not-started",$(()=>n.value="paused")),u("#canvas","always-show")},m=(e=!0)=>{r(".pause-icon",["paused","closed"]),r("#canvas","paused");try{s(t).loaded||t.value.loadSound(),e&&s(l)&&t.value.playSound(),n.value="playing"}catch(a){console.error(a),console.warn("Error playing sound"),n.value="disposed"}},z=e=>{if(e.preventDefault(),!s(t)){l.value=!1,g()&&(t.value.loadSound(),r(".pause-icon",["closed","paused"]));return}if(s(n)==="playing"){if(!t.value.loaded||!t.value.isPlaying)return;t.value.pauseSound(),n.value="paused";const a=document.getElementById("hero");if(a){const o=["hover","foreground"];(!x(a,"foreground")||!x(a,"hover"))&&u(a,o)}u(".pause-icon","paused"),u("#canvas","paused")}else s(n)==="paused"?(t.value.dispose(),n.value="disposed",u(".pause-icon","closed"),t.value=null,v.value=null):s(n)},D=e=>{if(n.value=e==="running"?"playing":e==="suspended"?"paused":e==="closed"?"disposed":"not-started",s(n)!=="playing")if(s(n)==="paused"){const a=document.getElementById("hero");a&&r(a,["foreground"]),m()}else s(n)==="not-started"&&(t.value.loadSound(),m())},f=d("49");p("music-top",()=>f.value);const _=()=>{setTimeout(()=>{f.value=p("music-top").value+"px"},300)},g=()=>"__lazyMusicLoader"in window&&c.musicFile.length>0&&!s(l)?(window.__lazyMusicLoader.then(e=>{if(v.value=e(),s(v)){if(t.value=v.value(D),!s(t))return!1;m(!1)}else return!1}),l.value=!0,!!s(t)):(l.value=!1,!1),E=e=>{_(),s(l)||g(),u(s(i),"activated")},S=e=>{if(e.target===i.value){e.stopPropagation();const a=document.getElementById("hero");a&&u(a,["hover"])}},C=e=>{if(e.target===i.value){e.stopPropagation();const a=document.getElementById("hero");a&&r(a,["hover"])}},h=()=>{_()};return P(()=>{var e,a,o;w(()=>c.musicFile,y=>{var k;(k=t.value)==null||k.dispose(),l.value=!1,g(),n.value="playing"}),(e=document.querySelector(".app"))==null||e.addEventListener("onDockingStationAvailable",h),w(p("music-top"),()=>{h()},{immediate:!0}),document.documentElement.addEventListener("click",E),(a=i.value)==null||a.addEventListener("mouseenter",S),(o=i.value)==null||o.addEventListener("mouseleave",C)}),V(()=>{var e,a,o,y;(e=document.querySelector(".app"))==null||e.removeEventListener("onDockingStationAvailable",h),(a=t.value)==null||a.dispose(),l.value=!1,document.documentElement.removeEventListener("click",E),(o=i.value)==null||o.removeEventListener("mouseenter",S),(y=i.value)==null||y.removeEventListener("mouseleave",C)}),(e,a)=>{const o=I;return L(),T("div",{class:"music",onClick:b},[M(o,{icon:"pause-icon",onClick:z}),c.musicFile.length>0?(L(),T("audio",{key:0,id:"audio",src:c.musicFile,"data-author":c.musicAuthor,"data-title":c.musicTitle,type:c.musicType},null,8,O)):q("",!0),M(U,{name:"bounce"},{default:N(()=>[j(H("canvas",{id:"canvas",width:"340",height:"400",ref_key:"canvas",ref:i},null,512),[[G,s(n)==="playing"||s(n)==="paused"]])]),_:1})])}}}),Y=J(Q,[["__scopeId","data-v-20f77fdd"]]);export{Y as default};
